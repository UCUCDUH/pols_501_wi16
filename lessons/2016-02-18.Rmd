---
title: "Tests of Proportions"
author: "Jeffrey Arnold"
date: "February 18, 2016"
output: html_document
---

```{r echo=FALSE,results='hide'}
source("init.R")
```


# 2016 Nevada Primaries

Consider this CNN poll of the Nevada Democratic and Republican Presidential Caucuses taken on Feb 10-12, 2016: http://elections.huffingtonpost.com/pollster/polls/cnn-23764.
The full poll results are here: http://i2.cdn.turner.com/cnn/2016/images/02/17/topnv1.pdf

- Calculate the standard error and 95% confidence interval of Donald Trump's proportion of support? 
- Calculate the standard error and 95% confidence interval of Bernie Sanders proportion of support?
- Can you calculate the confidence interval of the difference between Ted Cruz and Marco Rubio's support? What assumption is violated.
- Look at the most recent values of Huffpost Pollster Trend. Use a Chi-squared test to compare the poll-results to those in the Pollster trend.
- Is support for Hillary Clinton and Bernie Sanders independent of age? See p. 33 of the full poll results. Use a Chi-squared test of independence.
- Is support for Hillary Clinton different between men and women? Use a confidence interval and a hypothesis test for a difference of proportions.

# Difference in Statistical Significance does not mean the difference is statistically significant

Consider two samples of size 100 from independent populations.
Sample 1 has a mean of $\bar{x}_1 = 0$, standard deviation of $s_1 = 10$.
Sample 2 has a mean of $\bar{x}_2 = 2.3$, and standard deviation of $s_2 = 10$.

- For sample 1, calculate its 95% confidence interval. Can you reject $H_0: \mu_1 = 0$ at the 5% significance level (assume a two-sided test)?
- Do the same for sample 2? 
- Calculate the confidence interval for the difference $\mu_1 - \mu_2$? Can you reject $H_0: \mu_1 = \mu_2$? 

```{r}
x_bar_1 <- 0
s_1 <- 10
n_1 <- 100
se_1 <- s_1 / sqrt(n_1)

x_bar_2 <- 2.25
s_2 <- s_1
n_2 <- n_1
se_2 <- s_2 / sqrt(n_2)
```

The 95% confidence interval of $\mu_1$:
```{r}
x_bar_1 + c(-1, 1) * 1.96 * se_1
```
The 95% confidence interval of $\mu_2$:
```{r}
x_bar_2 + c(-1, 1) * 1.96 * se_2
```

The 95% confidence interval of $\mu_1 - \mu_2$:
```{r}
se_diff <- sqrt(se_1 ^ 2 + se_2 ^ 2)
(x_bar_1 - x_bar_2) + c(-1, 1) * 1.96 * se_diff
```

# Overlapping Confidence intervals

## Example 1

Consider two samples of size 100 from independent populations.
Sample 1 has a mean of $\bar{x}_1 = 0$, standard deviation of $s_1 = 10$.
Sample 2 has a mean of $\bar{x}_2 = 4$, and standard deviation of $s_2 = 10$.

- Calculate the 95% confidence intervals of $\mu_1$, and $\mu_2$?
- Do the confidence intervals of the mean for sample 1 and sample 2 overlap? From this can you conclude that you can reject $H_0: \mu_1 = \mu_2$ at the the 5% significance level?
- Calculate the confidence interval of $\mu_1 - \mu_2$. From this can you conclude that you can reject $H_0: \mu_1 = \mu_2$?

```{r}
x_bar_1 <- 0
s_1 <- 10
n_1 <- 100
se_1 <- s_1 / sqrt(n_1)

x_bar_2 <- 4
s_2 <- s_1
n_2 <- n_1
se_2 <- s_2 / sqrt(n_2)
```

The 95% confidence interval of $\mu_1$:
```{r}
x_bar_1 + c(-1, 1) * 1.96 * se_1
```
The 95% confidence interval of $\mu_2$:
```{r}
x_bar_2 + c(-1, 1) * 1.96 * se_2
```

The 95% confidence interval of $\mu_1 - \mu_2$:
```{r}
se_diff <- sqrt(se_1 ^ 2 + se_2 ^ 2)
(x_bar_1 - x_bar_2) + c(-1, 1) * 1.96 * se_diff
```

## Example 2

Consider two samples of size 100 from independent populations.
Sample 1 has a mean of $\bar{x}_1 = 0$, standard deviation of $s_1 = 10$.
Sample 2 has a mean of $\bar{x}_2 = 3$, and standard deviation of $s_2 = 10$.

- Calculate the 95% confidence intervals of $\mu_1$, and $\mu_2$?
- Do the confidence intervals of the mean for sample 1 and sample 2 overlap? From this can you conclude that you can reject $H_0: \mu_1 = \mu_2$ at the the 5% significance level?
- Calculate the confidence interval of $\mu_1 - \mu_2$. From this can you conclude that you can reject $H_0: \mu_1 = \mu_2$?

```{r}
x_bar_1 <- 0
s_1 <- 10
n_1 <- 100
se_1 <- s_1 / sqrt(n_1)

x_bar_2 <- 3
s_2 <- s_1
n_2 <- n_1
se_2 <- s_2 / sqrt(n_2)
```

The 95% confidence interval of $\mu_1$:
```{r}
x_bar_1 + c(-1, 1) * 1.96 * se_1
```
The 95% confidence interval of $\mu_2$:
```{r}
x_bar_2 + c(-1, 1) * 1.96 * se_2
```

The 95% confidence interval of $\mu_1 - \mu_2$:
```{r}
se_diff <- sqrt(se_1 ^ 2 + se_2 ^ 2)
(x_bar_1 - x_bar_2) + c(-1, 1) * 1.96 * se_diff
```

Why this difference? The sum of the standard errors of the two samples is always greater than the standard error of difference,
$$
(se_1 + se_2) > \sqrt{se_1^2 + se_2^2}
$$
```{r}
se_1 + se_2
se_diff
```

This means that if two confidence intervals are **not** overlapping, then the difference will also be significant.
But if the two means are overlapping, the difference may or may not be significant.

For more see this [handout](https://www.cscu.cornell.edu/news/statnews/Stnews73insert.pdf)

